<!-- Mermaid.js for diagram rendering -->
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@{{ site.mermaid.version | default: "10.6.1" }}/dist/mermaid.esm.min.mjs';
  
  mermaid.initialize({ 
    startOnLoad: true,
    theme: '{{ site.mermaid.theme | default: "default" }}',
    // Configuration for better GitHub Pages compatibility
    securityLevel: 'loose',
    fontFamily: '"Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif',
    // Ensure diagrams work with Jekyll's DOM structure
    htmlLabels: true,
    wrap: true,
    fontSize: 16
  });

  // Force re-render after page load for Jekyll compatibility
  document.addEventListener('DOMContentLoaded', function() {
    mermaid.init();
  });
</script>

<!-- Fallback for older browsers -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@{{ site.mermaid.version | default: "10.6.1" }}/dist/mermaid.min.js"></script>
<script>
  if (typeof mermaid === 'undefined') {
    document.addEventListener('DOMContentLoaded', function() {
      mermaid.initialize({ 
        startOnLoad: true,
        theme: '{{ site.mermaid.theme | default: "default" }}',
        securityLevel: 'loose',
        fontFamily: '"Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif',
        htmlLabels: true,
        wrap: true,
        fontSize: 16
      });
    });
  }
</script> 